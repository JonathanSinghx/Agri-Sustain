@using Agrisustain_Jamaica.Models
@using Agrisustain_Jamaica.Services
@using Microsoft.AspNetCore.Components.Web
@inject JSONFilePlantingGuidesService PlantingGuidesService


@{

    var PlantingGuidesInfo = PlantingGuidesService.GetPlantingGuidesInfo();
    var CropsInfo = PlantingGuidesService.GetData();

    string mainHeading = "";
    string blogID = "";

    List<string> blogIntroText = new List<string>();

    if(PlantingGuidesInfo != null)
    {
        foreach(var info in PlantingGuidesInfo)
        {
            if (info.PostID != null)
            {
                blogID = info.PostID;
            }

            if (info.MainHeading != null)
            {
                mainHeading = info.MainHeading;
            }

            if (info.BlogIntro != null)
            {
                for (int i = 0; i < info.BlogIntro.Length; i++)
                {
                    blogIntroText.Add(info.BlogIntro[i]);
                }

            }
            
        }
    }

    <section class="plantingGuides-page article-page">
        <aritcle class="row">
            <div class="d-flex flex-column flex-md-row gap-md-3 gap-lg-5 header-container">
                <div class="col col-md-5 header-img">
                    <img class="img-fluid" src="~/plantingGuidesImg.jpg" alt="Planting guides" />
                </div>
                <div class="col col-md-6 px-3 pt-3 py-md-0">
                    <h1 class="fw-bold lh-1 mb-4 [ main-heading ]">@mainHeading</h1>
                    <div class="main-intro-text">
                        @{
                            foreach (string text in blogIntroText)
                            {
                                <p>@text</p>
                            }
                        }
                    </div>
                </div>
            </div>
            <div class="row mt-4 p-4">
                <div class="search-container">
                    <h3>Search for Quicker Results</h3>
                    <div class="btns">
                        <button class="btn">Sort Alphabetically</button>
                        <button class="btn">Sort By Popularity</button>
                    </div>
                </div>
            </div>
            <div class="sub-sections">
                <div class="row flex-column px-3 mt-md-5">
                    @{
                        if (CropsInfo != null)
                        {
                            string season = "";
                            foreach (var crop in CropsInfo)
                            {
                                if (crop.CropInfo != null && crop.Seasons.Length > 1) { season = "seasons"; } else { season = "season"; }

                                <div class="col text-md-center col-md-10 mx-md-auto mb-md-3">
                                    <h2 class=" fw-bold fs-3">@crop.CropName</h2>
                                    <div class="row">
                                        <p class="fw-bold">Best @season for planting:</p>
                                        <ul class="d-flex justify-content-center gap-2 p-2 rounded-1 mx-md-auto">
                                            @for (int i = 0; i < crop.Seasons.Length; i++)
                                            {
                                                <li class="fs-6"><span class="mr-2">&star;</span>@crop.Seasons[i]</li>
                                            }
                                        </ul>
                                    </div>

                                    @for (int i = 0; i < crop.CropInfo.Length; i++ )
                                    {

                                        <p>@crop.CropInfo[i]</p>
                                    }

                                </div>

                            }
                        }
                    }
                </div>
            </div>
        </aritcle>
    </section>

}



